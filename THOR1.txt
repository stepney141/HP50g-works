%%HP: T(3)A(R)F(.);
DIR
  TST01
  \<< Init 1. 6.
    START Sub Relax TimeD
    NEXT
  \>>
  TimDT 3.7216796875
  RelxT 601.23046875
  SubT 164.455932617
  InitT 112.650268555
  TIME3
  \<< TICKS \-> X Y TICKA
    \<< X EVAL TICKS TICKA - B\->R 8192 / Y STO
    \>>
  \>>
  CT 1.
  \Ga .402145992696
  Time 1647.02160645
  Step -1
  ZT A5
  Res A5
  YACOB A5
  VOR A5
  PZ Zij
  FZ Zij
  Zij
[[ 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 5221.20951318 ]
 [ 5242.3647681 5252.64498256 5261.81117628 5268.87004992 5273.05666501 5273.91733683 5271.35879825 5265.6583066 5257.43359863 5247.57594905 5237.15358715 5227.29593757 5219.0712296 5213.37073795 5210.81219937 5211.67287119 5215.85948628 5222.91835992 5232.08455364 5242.3647681 5252.64498256 ]
 [ 5303.27889688 5322.59938022 5339.82618941 5353.09253236 5360.96079497 5362.57832889 5357.76984923 5347.05642937 5331.59903458 5313.07271345 5293.48508031 5274.95875918 5259.50136439 5248.78794453 5243.97946487 5245.59699879 5253.4652614 5266.73160435 5283.95841353 5303.27889688 5322.59938022 ]
 [ 5396.60475659 5422.63517338 5445.84479061 5463.71848612 5474.31936765 5476.49866521 5470.02021809 5455.58606656 5434.7603749 5409.79992995 5383.40958323 5358.44913828 5337.62344662 5323.18929509 5316.71084797 5318.89014553 5329.49102706 5347.36472257 5370.5743398 5396.60475659 5422.63517338 ]
 [ 5511.08587122 5540.68656903 5567.07957193 5587.40478852 5599.45966622 5601.93787197 5594.57085372 5578.15694221 5554.47483945 5526.09086873 5496.08087371 5467.69690299 5444.01480023 5427.60088872 5420.23387047 5422.71207622 5434.76695392 5455.09217051 5481.48517341 5511.08587122 5540.68656903 ]
 [ 5632.91412878 5662.51482659 5688.90782949 5709.23304608 5721.28792378 5723.76612953 5716.39911128 5699.98519977 5676.30309701 5647.91912629 5617.90913127 5589.52516055 5565.84305779 5549.42914628 5542.06212803 5544.54033378 5556.59521148 5576.92042807 5603.31343097 5632.91412878 5662.51482659 ]
 [ 5747.39524341 5773.4256602 5796.63527743 5814.50897294 5825.10985447 5827.28915203 5820.81070491 5806.37655338 5785.55086172 5760.59041677 5734.20007005 5709.2396251 5688.41393344 5673.97978191 5667.50133479 5669.68063235 5680.28151388 5698.15520939 5721.36482662 5747.39524341 5773.4256602 ]
 [ 5840.72110312 5860.04158646 5877.26839565 5890.5347386 5898.40300121 5900.02053513 5895.21205547 5884.49863561 5869.04124082 5850.51491969 5830.92728655 5812.40096542 5796.94357063 5786.23015077 5781.42167111 5783.03920503 5790.90746764 5804.17381059 5821.40061977 5840.72110312 5860.04158646 ]
 [ 5901.6352319 5911.91544636 5921.08164008 5928.14051372 5932.32712881 5933.18780063 5930.62926205 5924.9287704 5916.70406243 5906.84641285 5896.42405095 5886.56640137 5878.3416934 5872.64120175 5870.08266317 5870.94333499 5875.12995008 5882.18882372 5891.35501744 5901.6352319 5911.91544636 ]
 [ 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 5922.79048682 ]]
  Fij
[[ 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 24.0977871191 ]
 [ 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 23.1000217898 ]
 [ 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 22.1022564603 ]
 [ 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 21.1044911312 ]
 [ 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 20.106725802 ]
 [ 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 19.1089604727 ]
 [ 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 18.1111951434 ]
 [ 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 17.1134298141 ]
 [ 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 16.1156644847 ]
 [ 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 15.1178991554 ]]
  TIME2
  \<< TICKS \-> X TICKA
    \<< X EVAL TICKS TICKA - B\->R 8192 / 'Time' STO OFF
    \>>
  \>>
  A5
[[ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
 [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]]
  ComJA
  \<< 2. 9.
    FOR J 2. 20.
      FOR I YACOB { J I } .00198 VOR { J 'I+1.' } GET VOR { J 'I-1.' } GET - Zij { 'J-1.' I } GET Zij { 'J+1.' I } GET - * VOR { 'J-1.' I } GET VOR { 'J+1.' I } GET - Zij { J 'I+1.' } GET Zij { J 'I-1.' } GET - * - * PUT 'YACOB' STO
      NEXT
    NEXT
  \>>
  ComVO
  \<< 2. 9.
    FOR J 2. 20.
      FOR I VOR { J I } Zij { J 'I+1.' } GET Zij { J 'I-1.' } GET + Zij { 'J+1.' I } GET + Zij { 'J-1.' I } GET + Zij { J I } GET 4 * - Fij { J I } GET + PUT 'VOR' STO
      NEXT
    NEXT 2. 20.
    FOR I VOR { 1. I } Fij { 1. I } GET PUT 'VOR' STO VOR { 10. I } Fij { 10. I } GET PUT 'VOR' STO
    NEXT 'VOR' Cycle
  \>>
  ComID
  \<< '.0001/9.8' \->NUM '(9.*300.)*1000.' \->NUM '(19.*300)*1000.' \->NUM \-> FBG FD FL
    \<< '((FBG*40.)*FD)/\pi' \->NUM '((FBG*10.)*FL)/(2.*\pi)' \->NUM \-> UCON VCON
      \<< 1. 10.
        FOR J 1. 21.
          FOR I Zij { J I } '(5572.+(UCON*COS(((10-J)*\pi)/9)))+((VCON*SIN((((I-1)*2)*\pi)/19))*SIN(((10-J)*\pi)/9))' \->NUM PUT 'Zij' STO
          NEXT
        NEXT 'Zij' Cycle
      \>>
    \>>
  \>>
  ComCP
  \<< { A5 A5 A5 A5 A5 A5 A5 A5 -1 } { Fij Zij FZ PZ VOR YACOB Res ZT Step } STO .00918 '(((4.*\pi)*.743)*300.)/(86400.*6371.)' \->NUM \-> AM BETA
    \<< 1. 10.
      FOR J 1. 21.
        FOR I Fij { J I } '((.0001+(BETA*(5.5-J)))*1800.)/AM' \->NUM PUT 'Fij' STO
        NEXT
      NEXT
    \>>
  \>>
  Cycle
  \<< \-> A
    \<< 1. 10.
      FOR J A EVAL { J 21 } A EVAL { J 2 } GET PUT A STO A EVAL { J 1 } A EVAL { J 20 } GET PUT A STO
      NEXT
    \>>
  \>>
  TimeD
  \<<
    CASE Step 0. ==
      THEN .5 'CT' STO 'Step' DUP INCR SWAP STO
      END Step 0. >
      THEN 1. 'CT' STO 'Step' DUP INCR SWAP STO
      END Step 0. <
      THEN .25 'CT' STO 'Step' DUP INCR SWAP STO
      END
    END 'ZT' Cycle ZT CT * PZ + 'FZ' STO
    IF Step 1. <
    THEN
    ELSE Zij 'PZ' STO
    END FZ 'Zij' STO
  \>>
  Relax
  \<< { A5 A5 } { ZT Res } STO 2. 9.
    FOR J 2. 20.
      FOR I
        DO ZT { J I } DUP2 GET ZT { J 'I-1.' } GET ZT { J 'I+1.' } GET + ZT { 'J-1.' I } GET + ZT { 'J+1.' I } GET + ZT { J I } GET 4. * - YACOB { J I } GET + Res { J I } PICK3 PUT 'Res' STO \Ga * + PUT 'ZT' STO
        UNTIL Res { J I } GET ABS .1 <
        END
      NEXT
    NEXT
  \>>
  Sub
  \<< ComVO ComJA
  \>>
  Init
  \<< ComCP ComID { Zij Zij } { FZ PZ } STO
  \>>
END
